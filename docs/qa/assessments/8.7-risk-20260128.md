# Risk Profile: Story 8.7 Integration Testing

Date: 2026-01-28
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 8
- Critical Risks: 0
- High Risks: 2
- Risk Score: 76/100 (moderate risk)

This story focuses on integration testing for XML workflows. The risks are primarily related to test infrastructure, cross-browser compatibility, and test coverage completeness rather than production code changes.

## Risk Matrix

| Risk ID   | Description                              | Probability | Impact     | Score | Priority |
|-----------|------------------------------------------|-------------|------------|-------|----------|
| TECH-001  | WASM async timing issues in tests        | High (3)    | Medium (2) | 6     | High     |
| TECH-002  | Cross-browser test environment setup     | Medium (2)  | High (3)   | 6     | High     |
| TECH-003  | Qt signal/slot timing in integration     | Medium (2)  | Medium (2) | 4     | Medium   |
| PERF-001  | Large file tests (1MB) flaky timeouts    | Medium (2)  | Medium (2) | 4     | Medium   |
| DATA-001  | Test fixture data inconsistency          | Low (1)     | Medium (2) | 2     | Low      |
| OPS-001   | CI pipeline resource constraints         | Low (1)     | Medium (2) | 2     | Low      |
| OPS-002   | Manual browser testing gaps              | Medium (2)  | Low (1)    | 2     | Low      |
| BUS-001   | Incomplete regression coverage           | Low (1)     | Medium (2) | 2     | Low      |

## Critical Risks Requiring Immediate Attention

**None identified.** This is a testing story with no production code modifications.

## High Risks (Score 6)

### TECH-001: WASM Async Timing Issues in Tests

**Score: 6 (High)**
**Probability**: High - Asyncify and WASM async operations are known to have timing edge cases
**Impact**: Medium - Flaky tests undermine confidence but don't affect production

**Affected Components:**
- `qt/tests/integration/tst_xml_integration.cpp`
- `AsyncSerialiser` usage in tests

**Mitigation:**
- Use `QSignalSpy::wait()` with appropriate timeouts (5000ms minimum)
- Leverage `AsyncSerialiser` to serialize test operations
- Add explicit state checks before assertions
- Document known flaky test patterns

**Testing Focus**: Run test suite 10x in CI to identify intermittent failures

---

### TECH-002: Cross-Browser Test Environment Setup

**Score: 6 (High)**
**Probability**: Medium - Each browser has quirks with WASM and Qt
**Impact**: High - Untested browser = potential production failures

**Affected Components:**
- Manual test execution across Chrome, Firefox, Safari, Edge
- Qt WASM rendering differences

**Mitigation:**
- Create explicit browser test matrix with versions
- Document known browser-specific behaviors
- Prioritize Chrome (primary) → Firefox → Edge → Safari (lowest priority)
- Use BrowserStack or similar if Safari access limited

**Testing Focus**: Document browser-specific deviations, don't block on Safari edge cases

---

## Medium Risks (Score 4)

### TECH-003: Qt Signal/Slot Timing in Integration

**Score: 4 (Medium)**
**Probability**: Medium - Signal emissions may race with test assertions
**Impact**: Medium - Test failures that don't reflect production issues

**Mitigation:**
- Use `QTest::qWaitFor()` for state checks
- Avoid immediate assertions after signal emissions
- Consider adding test-mode signal synchronization

---

### PERF-001: Large File Tests (1MB) Flaky Timeouts

**Score: 4 (Medium)**
**Probability**: Medium - CI environments vary in performance
**Impact**: Medium - Flaky CI blocks merges

**Mitigation:**
- Set generous timeout (30s) for 1MB tests
- Make large file tests optional/skippable in CI
- Document baseline timings for regression detection

---

## Low Risks (Score 2-3)

### DATA-001: Test Fixture Data Inconsistency

**Mitigation:** Version control test fixtures, use deterministic data generation

### OPS-001: CI Pipeline Resource Constraints

**Mitigation:** Monitor CI timing, consider caching WASM builds

### OPS-002: Manual Browser Testing Gaps

**Mitigation:** Create structured checklist, consider screenshot capture

### BUS-001: Incomplete Regression Coverage

**Mitigation:** Map JSON tests explicitly, ensure TreeView, history, and all existing features covered

---

## Risk Distribution

### By Category

- Technical: 3 risks (2 high)
- Performance: 1 risk (0 critical)
- Data: 1 risk (0 critical)
- Business: 1 risk (0 critical)
- Operational: 2 risks (0 critical)
- Security: 0 risks

### By Component

- Integration Test Suite: 4 risks
- CI/CD Pipeline: 2 risks
- Manual Testing: 2 risks

---

## Detailed Risk Register

| Risk ID  | Category    | Title                              | Prob | Impact | Score | Mitigation Strategy      | Owner | Status   |
|----------|-------------|------------------------------------|------|--------|-------|--------------------------|-------|----------|
| TECH-001 | Technical   | WASM async timing in tests         | 3    | 2      | 6     | Use QSignalSpy timeouts  | Dev   | Open     |
| TECH-002 | Technical   | Cross-browser setup                | 2    | 3      | 6     | Browser matrix, fallback | QA    | Open     |
| TECH-003 | Technical   | Qt signal timing                   | 2    | 2      | 4     | qWaitFor pattern         | Dev   | Open     |
| PERF-001 | Performance | Large file test timeouts           | 2    | 2      | 4     | Generous timeouts        | Dev   | Open     |
| DATA-001 | Data        | Fixture inconsistency              | 1    | 2      | 2     | Version fixtures         | Dev   | Open     |
| OPS-001  | Operational | CI resource limits                 | 1    | 2      | 2     | Cache builds             | DevOps| Open     |
| OPS-002  | Operational | Manual test gaps                   | 2    | 1      | 2     | Structured checklist     | QA    | Open     |
| BUS-001  | Business    | Regression coverage gaps           | 1    | 2      | 2     | Explicit test mapping    | QA    | Open     |

---

## Risk-Based Testing Strategy

### Priority 1: High Risk Tests

- [ ] Verify WASM async operations complete reliably in integration tests
- [ ] Test on Chrome, Firefox, Edge with full test suite
- [ ] Safari basic smoke test (lower priority)

### Priority 2: Medium Risk Tests

- [ ] Run tests with deliberate delays to catch timing issues
- [ ] Test 1MB file with various CI load conditions
- [ ] Validate Qt signals are properly awaited

### Priority 3: Low Risk Tests

- [ ] Verify test fixtures match expected format
- [ ] Run CI build caching verification
- [ ] Execute manual test checklist completely

---

## Risk Acceptance Criteria

### Must Fix Before Production

- None (testing story does not affect production)

### Must Fix Before Sign-off

- All high risks (TECH-001, TECH-002) must have documented mitigations
- Cross-browser matrix must show PASS for Chrome, Firefox, Edge

### Can Deploy with Mitigation

- Safari issues can be documented as known limitations
- Large file tests can be marked as slow/optional

### Accepted Risks

- Safari edge cases: Document and accept (low user base)
- CI variability: Retry mechanisms acceptable

---

## Monitoring Requirements

Post-test-suite-delivery monitoring:

- Track CI test execution times for performance regression
- Monitor test flake rate (target: <5%)
- Alert on browser-specific failures in manual testing

---

## Risk Review Triggers

Review and update risk profile when:

- New browser version released (quarterly)
- AsyncSerialiser implementation changes
- CI infrastructure changes
- Test framework upgrades

---

## Gate YAML Block

```yaml
# risk_summary (paste into gate file):
risk_summary:
  totals:
    critical: 0
    high: 2
    medium: 2
    low: 4
  highest:
    id: TECH-001
    score: 6
    title: 'WASM async timing issues in tests'
  recommendations:
    must_fix:
      - 'Document QSignalSpy timeout patterns for WASM tests'
      - 'Create explicit cross-browser test matrix with pass/fail tracking'
    monitor:
      - 'Track test flake rate in CI'
      - 'Monitor large file test timings'
```

---

Risk profile: docs/qa/assessments/8.7-risk-20260128.md
