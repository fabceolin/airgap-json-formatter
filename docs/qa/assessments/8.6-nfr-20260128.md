# NFR Assessment: 8.6

Date: 2026-01-28
Reviewer: Quinn (Test Architect)

## Summary

- Security: PASS - QXmlStreamReader has secure defaults, airgap architecture prevents external entity resolution
- Performance: CONCERNS - Target defined (10K nodes <2s) but no memory limits in acceptance criteria
- Reliability: CONCERNS - Basic error handling present but no explicit malformed XML recovery requirements
- Maintainability: PASS - Follows QJsonTreeModel pattern, clear test structure

## Quality Score: 80/100

## Critical Issues

1. **No memory limit specified** (Performance)
   - Risk: Memory exhaustion on very large XML documents
   - Fix: Add node count guard (suggested 50,000) to acceptance criteria or as explicit task
   - Reference: Risk PERF-001 in risk profile

2. **Missing malformed XML handling requirements** (Reliability)
   - Risk: Unclear behavior on invalid XML, potential for unhelpful errors
   - Fix: Add acceptance criterion for graceful error handling with user-friendly messages
   - Fix: Add negative test cases for malformed XML

## Recommendations

### Security - No Action Required
- QXmlStreamReader secure by default (doesn't resolve external entities)
- Airgap architecture enforces client-side only processing
- Consider documenting DTD disabled state for defense-in-depth

### Performance - Action Recommended
1. Add to AC8 or new AC: "Node count guard prevents loading documents >50,000 nodes with clear error message"
2. Add memory profiling to Task 8: "Test with Valgrind/AddressSanitizer for memory leaks"

### Reliability - Action Recommended
1. Add new AC: "Malformed XML displays user-friendly error message with line/column position"
2. Add to Testing section:
   - Malformed XML: unclosed tags
   - Malformed XML: invalid characters
   - Malformed XML: encoding mismatches
3. Specify partial tree behavior: clear on failure or show partial result

### Maintainability - Consider
1. Define test coverage target (suggest 80% for new code)
2. Add API documentation comments requirement

## NFR Threshold Sources

| NFR | Source | Threshold |
|-----|--------|-----------|
| Performance | Story AC8 | 10,000 nodes in <2s |
| Memory | Risk Profile PERF-001 | 50,000 node suggested limit |
| Security | Architecture doc | Zero network calls, airgap |
| Reliability | - | Target unknown - no explicit error handling requirements |
| Maintainability | - | Target unknown - no test coverage target specified |

## Gate YAML Block

```yaml
# Gate YAML (copy/paste):
nfr_validation:
  _assessed: [security, performance, reliability, maintainability]
  security:
    status: PASS
    notes: 'QXmlStreamReader has secure defaults, airgap architecture enforced'
  performance:
    status: CONCERNS
    notes: 'Target 10K nodes <2s defined, but no memory limit in AC - recommend 50K node guard'
  reliability:
    status: CONCERNS
    notes: 'Basic error handling present, missing explicit malformed XML recovery requirements'
  maintainability:
    status: PASS
    notes: 'Follows QJsonTreeModel pattern, test file and cases specified'
```

---

NFR assessment: docs/qa/assessments/8.6-nfr-20260128.md

Gate NFR block ready â†’ paste into docs/qa/gates/8.6-xml-tree-model.yml under nfr_validation
