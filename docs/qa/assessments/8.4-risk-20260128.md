# Risk Profile: Story 8.4

Date: 2026-01-28
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 7
- Critical Risks: 0
- High Risks: 0
- Medium Risks: 0
- Low Risks: 3
- Minimal Risks: 4
- Risk Score: 86/100 (Minimal Risk)

This is a low-risk story with straightforward detection logic. No critical or high risks identified. The main considerations are edge case handling and potential performance implications for very large inputs.

## Risk Distribution

### By Category

- Technical: 3 risks (0 critical)
- Performance: 1 risk (0 critical)
- Data: 1 risk (0 critical)
- Business: 1 risk (0 critical)
- Operational: 1 risk (0 critical)
- Security: 0 risks

### By Component

- C++ Bridge (JsonBridge): 3 risks
- QML UI (Main.qml, Toolbar.qml): 2 risks
- Detection Algorithm: 2 risks

## Detailed Risk Register

| Risk ID   | Category    | Description                                    | Probability | Impact  | Score | Priority |
|-----------|-------------|------------------------------------------------|-------------|---------|-------|----------|
| TECH-001  | Technical   | Detection edge cases (unknown inputs)          | Medium (2)  | Low (1) | 2     | Low      |
| TECH-002  | Technical   | Signal/property sync race                      | Low (1)     | Low (1) | 1     | Minimal  |
| TECH-003  | Technical   | QML binding performance on typing              | Medium (2)  | Low (1) | 2     | Low      |
| PERF-001  | Performance | Large input trimmed() copy overhead            | Low (1)     | Low (1) | 1     | Minimal  |
| DATA-001  | Data        | Detected format ≠ valid format                 | Medium (2)  | Low (1) | 2     | Low      |
| BUS-001   | Business    | User expects smarter detection                 | Low (1)     | Low (1) | 1     | Minimal  |
| OPS-001   | Operational | Optional UI indicator not tested               | Low (1)     | Low (1) | 1     | Minimal  |

## Low Priority Risk Details

### TECH-001: Detection Edge Cases

**Score: 2 (Low)**
**Probability**: Medium - Common inputs have clear prefixes (`{`, `[`, `<`), but edge cases exist
**Impact**: Low - Falls back to JSON (current behavior), user gets actionable parse error

**Affected Components:**
- `jsonbridge.cpp` - `detectFormat()` method

**Detection Method:** Code review of detection algorithm

**Mitigation:**
- Strategy: Preventive
- Actions:
  - Document known edge cases in Dev Notes table
  - Ensure "unknown" defaults to JSON (current behavior preserved)
  - Add tests for edge cases: `null`, `123`, `hello`, empty, whitespace-only
- Testing Requirements:
  - Unit tests for all edge case inputs from Dev Notes table
  - Verify "unknown" → JSON fallback behavior
- Residual Risk: Low - Edge cases documented, fallback behavior safe
- Owner: Dev
- Timeline: During implementation

### TECH-003: QML Binding Performance

**Score: 2 (Low)**
**Probability**: Medium - Large paste operations trigger detection
**Impact**: Low - UI lag during paste, but detection is fast

**Affected Components:**
- `Main.qml` - `onTextChanged` handler

**Mitigation:**
- Strategy: Preventive
- Actions:
  - Detection only inspects first non-whitespace character
  - Consider debounce if performance issues reported
  - AC7 requires <1ms detection for any input size
- Testing Requirements:
  - Performance test with large inputs (1MB+)
  - Verify <1ms detection latency
- Residual Risk: Minimal - Algorithm is O(whitespace) not O(input)
- Owner: Dev
- Timeline: During implementation

### DATA-001: Detection vs Validation Mismatch

**Score: 2 (Low)**
**Probability**: Medium - Partially edited content common
**Impact**: Low - Parse error clarifies actual issue, no data loss

**Affected Components:**
- User expectations

**Mitigation:**
- Strategy: Detective
- Actions:
  - Detection labeled as format hint, not validation
  - Parse errors remain actionable with line/column positions
  - No user confusion: detected format is best guess
- Testing Requirements:
  - Test invalid content with correct detection prefix
  - Verify error messages are clear
- Residual Risk: Minimal - Error handling from formatters provides clarity
- Owner: Dev
- Timeline: During implementation

## Risk-Based Testing Strategy

### Priority 1: Critical Risk Tests

N/A - No critical risks identified

### Priority 2: Core Detection Logic (Low Risk Coverage)

| Test ID | Scenario | Input | Expected |
|---------|----------|-------|----------|
| 8.4-001 | JSON object detection | `{"a":1}` | "json" |
| 8.4-002 | JSON array detection | `[1,2,3]` | "json" |
| 8.4-003 | XML element detection | `<root/>` | "xml" |
| 8.4-004 | XML declaration | `<?xml version="1.0"?>` | "xml" |
| 8.4-005 | Unknown content | `hello world` | "unknown" |
| 8.4-006 | Empty input | `` | "unknown" |
| 8.4-007 | Whitespace leading | `  \n  {"a":1}` | "json" |
| 8.4-008 | Whitespace leading XML | `  \n  <root/>` | "xml" |
| 8.4-009 | Whitespace only | `   ` | "unknown" |

### Priority 3: Integration Tests

| Test ID | Scenario | Steps | Expected |
|---------|----------|-------|----------|
| 8.4-INT-001 | Format button routing | Paste XML, click Format | formatXml() called |
| 8.4-INT-002 | Format button routing | Paste JSON, click Format | formatJson() called |
| 8.4-INT-003 | Signal emission | Paste content | `formatDetected` signal emits |
| 8.4-INT-004 | Property update | Paste XML | `detectedFormat` = "xml" |

### Priority 4: Performance/Edge Cases

| Test ID | Scenario | Input | Expected |
|---------|----------|-------|----------|
| 8.4-PERF-001 | Detection latency | Any input size | < 1ms |
| 8.4-EDGE-001 | JSON primitive | `null` | "unknown" |
| 8.4-EDGE-002 | Number | `123` | "unknown" |
| 8.4-EDGE-003 | HTML doctype | `<!DOCTYPE html>` | "xml" |

## Risk Acceptance Criteria

### Must Fix Before Production

None - No critical or high risks

### Can Deploy with Mitigation

All 7 risks can proceed with documented mitigations:
- Edge cases documented
- Performance monitoring in place
- Unknown defaults to JSON

### Accepted Risks

- TECH-001: Edge case detection limitations accepted (documented behavior)
- DATA-001: Detection ≠ validation mismatch accepted (error messages clarify)

## Monitoring Requirements

Post-deployment monitoring for:
- User feedback on detection accuracy
- Performance metrics for large input handling
- Error rates for format mismatch (detected XML but invalid)

## Risk Review Triggers

Review and update risk profile when:
- New format types added (e.g., YAML, TOML)
- Detection algorithm complexity increases
- Performance issues reported for large inputs
- User feedback indicates detection inaccuracy

## Gate YAML Block

```yaml
risk_summary:
  totals:
    critical: 0
    high: 0
    medium: 0
    low: 3
  highest:
    id: TECH-001
    score: 2
    title: 'Detection edge cases for unknown inputs'
  recommendations:
    must_fix: []
    monitor:
      - 'User feedback on detection accuracy for edge cases'
      - 'Performance profiling if large pastes reported slow'
```

---

Risk profile: docs/qa/assessments/8.4-risk-20260128.md
